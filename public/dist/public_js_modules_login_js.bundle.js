"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunknatours_review"] = self["webpackChunknatours_review"] || []).push([["public_js_modules_login_js"],{

/***/ "./public/js/modules/login.js":
/*!************************************!*\
  !*** ./public/js/modules/login.js ***!
  \************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n/**\r\n * Handles user login\r\n * @todo Add CSRF protection\r\n *\r\n * @param {String} formEl form DOM element\r\n */\nvar handleLogin = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (formEl) {\n    try {\n      // Handle form submit\n      // Form inputs\n      var formData = new FormData(formEl);\n      var email = formData.get('email');\n      var password = formData.get('password'); // Check if they are available before submiting\n\n      if (!email || !password) throw new Error('Email or Password missing'); // Submit data for processing\n\n      var submitUrl = '/api/v1/users/login';\n      var submitData = {\n        email,\n        password\n      };\n      var response = yield fetch(submitUrl, {\n        method: 'POST',\n        body: JSON.stringify(submitData),\n        credentials: 'same-origin',\n        referrerPolicy: 'no-referrer',\n        headers: {\n          'Content-Type': 'application/json; charset=utf-8'\n        }\n      });\n      var res = yield response.json(); /// Check for response errors\n\n      if (res.status !== 'success') {\n        throw new Error(res.message);\n      } /// Successful login\n      // TODO Add successful message\n\n\n      console.log('Login was successful'); // Redirect to /sys-admin\n      // TODO: Redirect /sys-admin\n\n      location.replace('/');\n    } catch (error) {\n      /// Catch errors heres\n      // TODO Implement messaging\n      console.log(error.name);\n      console.error(error);\n    }\n  });\n\n  return function handleLogin(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (handleLogin);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wdWJsaWMvanMvbW9kdWxlcy9sb2dpbi5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0E7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFMQTtBQVVBOztBQUdBO0FBQ0E7QUFDQTtBQUdBOzs7QUFDQTtBQUdBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBaERBO0FBQUE7QUFBQTtBQUFBOztBQWtEQSIsInNvdXJjZXMiOlsid2VicGFjazovL25hdG91cnMtcmV2aWV3Ly4vcHVibGljL2pzL21vZHVsZXMvbG9naW4uanM/NjNjYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogSGFuZGxlcyB1c2VyIGxvZ2luXHJcbiAqIEB0b2RvIEFkZCBDU1JGIHByb3RlY3Rpb25cclxuICpcclxuICogQHBhcmFtIHtTdHJpbmd9IGZvcm1FbCBmb3JtIERPTSBlbGVtZW50XHJcbiAqL1xyXG5jb25zdCBoYW5kbGVMb2dpbiA9IGFzeW5jIGZ1bmN0aW9uIChmb3JtRWwpIHtcclxuICB0cnkge1xyXG4gICAgLy8gSGFuZGxlIGZvcm0gc3VibWl0XHJcbiAgICAvLyBGb3JtIGlucHV0c1xyXG4gICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybUVsKTtcclxuICAgIGNvbnN0IGVtYWlsID0gZm9ybURhdGEuZ2V0KCdlbWFpbCcpO1xyXG4gICAgY29uc3QgcGFzc3dvcmQgPSBmb3JtRGF0YS5nZXQoJ3Bhc3N3b3JkJyk7XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgdGhleSBhcmUgYXZhaWxhYmxlIGJlZm9yZSBzdWJtaXRpbmdcclxuICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkKSB0aHJvdyBuZXcgRXJyb3IoJ0VtYWlsIG9yIFBhc3N3b3JkIG1pc3NpbmcnKTtcclxuXHJcbiAgICAvLyBTdWJtaXQgZGF0YSBmb3IgcHJvY2Vzc2luZ1xyXG4gICAgY29uc3Qgc3VibWl0VXJsID0gJy9hcGkvdjEvdXNlcnMvbG9naW4nO1xyXG4gICAgY29uc3Qgc3VibWl0RGF0YSA9IHtcclxuICAgICAgZW1haWwsXHJcbiAgICAgIHBhc3N3b3JkLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHN1Ym1pdFVybCwge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoc3VibWl0RGF0YSksXHJcbiAgICAgIGNyZWRlbnRpYWxzOiAnc2FtZS1vcmlnaW4nLFxyXG4gICAgICByZWZlcnJlclBvbGljeTogJ25vLXJlZmVycmVyJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG4gICAgLy8vIENoZWNrIGZvciByZXNwb25zZSBlcnJvcnNcclxuICAgIGlmIChyZXMuc3RhdHVzICE9PSAnc3VjY2VzcycpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcy5tZXNzYWdlKTtcclxuICAgIH1cclxuXHJcbiAgICAvLy8gU3VjY2Vzc2Z1bCBsb2dpblxyXG4gICAgLy8gVE9ETyBBZGQgc3VjY2Vzc2Z1bCBtZXNzYWdlXHJcbiAgICBjb25zb2xlLmxvZygnTG9naW4gd2FzIHN1Y2Nlc3NmdWwnKTtcclxuXHJcbiAgICAvLyBSZWRpcmVjdCB0byAvc3lzLWFkbWluXHJcbiAgICAvLyBUT0RPOiBSZWRpcmVjdCAvc3lzLWFkbWluXHJcbiAgICBsb2NhdGlvbi5yZXBsYWNlKCcvJyk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIC8vLyBDYXRjaCBlcnJvcnMgaGVyZXNcclxuICAgIC8vIFRPRE8gSW1wbGVtZW50IG1lc3NhZ2luZ1xyXG4gICAgY29uc29sZS5sb2coZXJyb3IubmFtZSk7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBoYW5kbGVMb2dpbjtcclxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./public/js/modules/login.js\n");

/***/ })

}]);