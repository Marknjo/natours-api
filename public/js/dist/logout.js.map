{"version":3,"file":"logout.js","sources":["../modules/logout.js"],"sourcesContent":["import { asyncErrorWrapper } from '../utils/handleErrors.js';\r\nimport httpRequestHelper, {\r\n  handleHttpErrors,\r\n} from '../utils/httpRequestsHelper.js';\r\nimport redirectTo from '../utils/redirectsHelper.js';\r\n\r\n/**\r\n * Logout user feature\r\n */\r\nconst handleLogout = async function () {\r\n  return asyncErrorWrapper(async () => {\r\n    // Send request to the server to logout user\r\n    const url = '/api/v1/users/logout';\r\n\r\n    /// Set origin url for tracking showOnPage\r\n    document.cookie = `originPageUrl=${\r\n      location.pathname\r\n    }; SameSite=Strict; expires:${new Date(Date.now() + 2 * 1000)} Secure`;\r\n\r\n    const response = await httpRequestHelper(url, {\r\n      requestMethod: 'GET',\r\n      sendPlainResponse: true,\r\n    });\r\n\r\n    if (!response.ok)\r\n      throw new Error('Server error, could not logout successfully.');\r\n\r\n    // Check for errors\r\n    await handleHttpErrors(\r\n      response,\r\n      'Logout failed ðŸ˜¢ðŸ˜¢ðŸ˜¢. It seems there is an error login out.'\r\n    );\r\n\r\n    // Successful logout -> Server will respond with the message\r\n\r\n    /// Handle redirects\r\n    const logoutFromUrl = location.pathname;\r\n\r\n    /// Redirect to\r\n    // Loggin out from admin dashboard\r\n    if (logoutFromUrl.startsWith('/sys-admin')) {\r\n      redirectTo('/', {\r\n        redirectOption: 'disallowGoBack',\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Loggin out from other client pages\r\n    redirectTo(logoutFromUrl, {\r\n      redirectOption: 'pageRefresh',\r\n    });\r\n  });\r\n};\r\n\r\n/// Export Log out feature\r\nexport default handleLogout;\r\n"],"names":[],"mappings":";AASK,MAAC,eAAe,iBAAkB;AACrC,SAAO,kBAAkB,YAAY;AAEnC,UAAM,MAAM;AAGZ,aAAS,SAAS,iBAChB,SAAS,sCACmB,IAAI,KAAK,KAAK,IAAK,IAAG,IAAI,GAAI;AAE5D,UAAM,WAAW,MAAM,kBAAkB,KAAK;AAAA,MAC5C,eAAe;AAAA,MACf,mBAAmB;AAAA,IACzB,CAAK;AAED,QAAI,CAAC,SAAS;AACZ,YAAM,IAAI,MAAM,8CAA8C;AAGhE,UAAM,iBACJ,UACA,kFACN;AAKI,UAAM,gBAAgB,SAAS;AAI/B,QAAI,cAAc,WAAW,YAAY,GAAG;AAC1C,iBAAW,KAAK;AAAA,QACd,gBAAgB;AAAA,MACxB,CAAO;AACD;AAAA,IACD;AAGD,eAAW,eAAe;AAAA,MACxB,gBAAgB;AAAA,IACtB,CAAK;AAAA,EACL,CAAG;AACH;;"}