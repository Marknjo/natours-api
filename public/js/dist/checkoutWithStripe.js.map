{"version":3,"file":"checkoutWithStripe.js","sources":["../modules/checkoutWithStripe.js"],"sourcesContent":["import { asyncErrorWrapper } from '../utils/handleErrors';\r\nimport httpRequestHelper, {\r\n  handleHttpErrors,\r\n} from '../utils/httpRequestsHelper';\r\n\r\nconst checkoutWithStripe = async (tourId, stripePublicKey) => {\r\n  return asyncErrorWrapper(async () => {\r\n    const stripe = Stripe(stripePublicKey);\r\n\r\n    /// Get stripe checkout sessions\r\n    const response = await httpRequestHelper(\r\n      `/api/v1/bookings/stripe-checkout/${tourId}`,\r\n      { requestMethod: 'GET', sendPlainResponse: true }\r\n    );\r\n\r\n    // Handle request errors, if any and get the session\r\n    const errorMessage =\r\n      'Error Checking out. We could not checkout you out at this time. If this error persists, kindly contact the administrator of this site.';\r\n    const session = await handleHttpErrors(response, errorMessage);\r\n\r\n    /// send user to checkout page if all is well\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  });\r\n};\r\n\r\nexport default checkoutWithStripe;\r\n"],"names":[],"mappings":";AAKK,MAAC,qBAAqB,OAAO,QAAQ,oBAAoB;AAC5D,SAAO,kBAAkB,YAAY;AACnC,UAAM,SAAS,OAAO,eAAe;AAGrC,UAAM,WAAW,MAAM,kBACrB,oCAAoC,UACpC,EAAE,eAAe,OAAO,mBAAmB,KAAM,CACvD;AAGI,UAAM,eACJ;AACF,UAAM,UAAU,MAAM,iBAAiB,UAAU,YAAY;AAG7D,UAAM,OAAO,mBAAmB;AAAA,MAC9B,WAAW,QAAQ,KAAK,QAAQ;AAAA,IACtC,CAAK;AAAA,EACL,CAAG;AACH;;"}